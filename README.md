# STM32智能垃圾桶控制系统

## 📋 项目概述

这是一个基于STM32F103微控制器的智能垃圾桶控制系统，具备自动感应开关、状态显示、灯光控制和用户交互等功能。

## ✨ 主要功能

### 🔍 智能感应开关
- **超声波测距**：使用HC-SR04模块检测物体距离
- **自动开盖**：检测到物体靠近时自动打开垃圾桶盖
- **自动关盖**：5秒后或物体远离时自动关闭垃圾桶盖
- **防抖处理**：距离检测防抖算法，避免误触发

### 💡 智能灯光控制
- **光敏传感器**：根据环境光线自动控制LED照明
- **节能模式**：光线充足时自动关闭照明灯

### 📱 用户交互界面
- **OLED显示屏**：实时显示系统状态、距离信息
- **按键控制**：支持手动启动/停止系统
- **蜂鸣器提示**：操作反馈和状态提示音

### 🔧 系统控制
- **状态管理**：完整的系统状态机设计
- **安全保护**：异常情况自动保护机制
- **稳定运行**：优化的控制算法和延时处理

## 🛠️ 硬件配置

### 主控芯片
- **STM32F103C8T6**：ARM Cortex-M3内核，72MHz主频

### 传感器模块
| 模块 | 功能 | 连接引脚 |
|------|------|----------|
| HC-SR04超声波 | 距离检测 | PA0(Trig), PA1(Echo) |
| 光敏传感器 | 光线检测 | PB13 |
| 舵机 | 垃圾桶盖控制 | PA3(PWM) |

### 显示与交互
| 模块 | 功能 | 连接引脚 |
|------|------|----------|
| OLED显示屏 | 状态显示 | PB8(SCL), PB9(SDA) |
| LED照明灯 | 垃圾桶照明 | PA2(LED1), PA4(LED2) |
| 蜂鸣器 | 声音提示 | PB12 |
| 按键 | 用户控制 | PB1(K1), PB11(K2) |

## 📁 项目结构

```
STM32/
├── Hardware/          # 硬件驱动模块
│   ├── Buzzer.c/h     # 蜂鸣器控制
│   ├── HCSR04.c/h     # 超声波测距
│   ├── Key.c/h        # 按键检测
│   ├── LED.c/h        # LED控制
│   ├── LightSensor.c/h # 光敏传感器
│   ├── OLED.c/h       # OLED显示
│   ├── PWM.c/h        # PWM输出
│   └── Servo.c/h      # 舵机控制
├── Library/           # STM32标准库
├── System/            # 系统功能
│   ├── Delay.c/h     # 延时函数
│   └── Timer.c/h     # 定时器
├── User/             # 用户代码
│   ├── main.c        # 主程序
│   ├── stm32f10x_it.c/h # 中断服务
│   └── stm32f10x_conf.h # 配置文件
└── Project.uvprojx   # Keil工程文件
```

## 🔌 引脚分配表

### GPIOA端口
| 引脚 | 功能 | 模块 | 备注 |
|------|------|------|------|
| PA0 | Trig输出 | HC-SR04 | 超声波触发信号 |
| PA1 | Echo输入 | HC-SR04 | 超声波回波信号 |
| PA2 | LED1控制 | LED模块 | 照明灯1 |
| PA3 | PWM输出 | 舵机控制 | TIM2_CH3 |
| PA4 | LED2控制 | LED模块 | 照明灯2 |

### GPIOB端口
| 引脚 | 功能 | 模块 | 备注 |
|------|------|------|------|
| PB1 | 按键1输入 | 按键模块 | 系统启动 |
| PB8 | OLED_SCL | OLED显示 | I2C时钟 |
| PB9 | OLED_SDA | OLED显示 | I2C数据 |
| PB11 | 按键2输入 | 按键模块 | 系统停止 |
| PB12 | 蜂鸣器输出 | 蜂鸣器模块 | 声音提示 |
| PB13 | 光敏传感器输入 | 光敏模块 | 光线检测 |

## 🚀 快速开始

### 1. 开发环境
- **IDE**: Keil MDK-ARM uVision5
- **编译器**: ARMCC V5
- **调试器**: ST-Link/V2

### 2. 硬件连接
按照引脚分配表连接各模块，确保电源和地线连接正确。

### 3. 编译与下载
1. 打开 `Project.uvprojx` 工程文件
2. 编译项目（F7）
3. 下载到STM32开发板（F8）
4. 复位运行

### 4. 系统操作
- **启动系统**: 按下K1按键
- **停止系统**: 按下K2按键
- **自动模式**: 系统启动后自动感应开关

## ⚙️ 技术规格

### 性能参数
- **检测距离**: 2cm - 400cm
- **检测精度**: ±3mm
- **响应时间**: <100ms
- **工作电压**: 3.3V DC
- **工作温度**: -10°C ~ 60°C

### 系统特性
- **低功耗设计**: 智能休眠模式
- **稳定可靠**: 多重保护机制
- **易于扩展**: 模块化设计
- **用户友好**: 直观的操作界面

## 🔧 故障排除

### 常见问题
1. **系统不启动**: 检查电源连接和复位电路
2. **超声波不工作**: 检查Trig和Echo引脚连接
3. **舵机不转动**: 检查PWM信号和电源电压
4. **OLED不显示**: 检查I2C总线和电源

### 调试建议
- 使用串口调试输出状态信息
- 检查各模块的初始化顺序
- 验证引脚配置无冲突

## 📈 未来扩展

### 计划功能
- [ ] 无线通信（WiFi/蓝牙）
- [ ] 语音控制功能
- [ ] 垃圾满溢检测
- [ ] 远程监控功能
- [ ] 数据统计功能

### 硬件升级
- [ ] 增加温度传感器
- [ ] 添加湿度检测
- [ ] 集成RFID识别
- [ ] 太阳能供电

## 👥 贡献指南

欢迎提交Issue和Pull Request来改进项目！

### 开发规范
- 遵循STM32标准库编程规范
- 使用有意义的变量和函数命名
- 添加必要的注释说明
- 测试所有修改的功能

## 📄 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 📞 联系方式

如有问题或建议，请联系项目维护者。

---

**最后更新**: 2024年
**版本**: v1.0
**状态**: ✅ 稳定运行